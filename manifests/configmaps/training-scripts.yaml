# ConfigMap 示例：训练脚本
# 用于将脚本挂载到 Pod 中

apiVersion: v1
kind: ConfigMap
metadata:
  name: training-scripts
  namespace: default
data:
  train.py: |
    #!/usr/bin/env python3
    import os
    import time
    
    print("开始训练...")
    print(f"数据目录: {os.environ.get('DATA_DIR', '/data/input')}")
    print(f"输出目录: {os.environ.get('OUTPUT_DIR', '/data/output')}")
    
    # 模拟训练
    time.sleep(60)
    
    # 保存结果
    with open('/data/output/model.pth', 'w') as f:
        f.write('model weights')
    
    print("训练完成！")
  
  run.sh: |
    #!/bin/bash
    set -e
    
    DATA_DIR=${DATA_DIR:-/data/input}
    OUTPUT_DIR=${OUTPUT_DIR:-/data/output}
    
    echo "数据目录: $DATA_DIR"
    echo "输出目录: $OUTPUT_DIR"
    
    # 执行训练
    python3 /workspace/scripts/train.py
    
    echo "训练完成，结果保存在: $OUTPUT_DIR"
